<style>
    div.abtest-control{
        display: block;
    }
    div.abtest-var1{
        display: none;
    }
    /*div.abtest-var1 .selectize-control{
        display: none
    }*/
    div.abtest-var1 .product-meta-mobile{
        display: none;
    }
    div.abtest-var1 .selectize-dropdown.plugin-optgroup_columns .optgroup:before {
        display: none;
    }
    div.abtest-var1 .selectize-control.plugin-remove_button [data-value] .remove {
        display: inline-block;
    }
    div.abtest-var1 .selectize-input,
    div.abtest-var1 .selectize-control.single .selectize-input.input-active {
        cursor: text;
        display: inline-block;
    }
    div.abtest-var1 .selectize-input {
        display: inline-block;
    }
    div.abtest-var1 .selectize-input > * {
        vertical-align: baseline;
        display: -moz-inline-stack;
        display: inline-block;
        zoom: 1;
        *display: inline;
    }
    div.abtest-var1 .selectize-input > input::-ms-clear {
        display: none;
    }
    div.abtest-var1 .selectize-dropdown .optgroup:first-child:before {
        display: none;
    }
    div.abtest-var1 .selectize-input.dropdown-active::before {
        display: none;
    }
    BODY.product-abtest div.abtest-control h2 {
        font-size: 32px;
        margin-bottom: 10px;
    }
    BODY.product-abtest div.abtest-control h1 {
        font-size: 20px;
        margin-bottom: 10px;
    }
    BODY.product-abtest div.abtest-control H3{
        margin-bottom: 20px;
        font-size: 16px;
    }
    @media (max-width: 640px) {
        BODY.product-abtest h2 {
            font-size: 32px;
            margin-bottom: 10px;
        }
        BODY.product-abtest h1 {
            font-size: 20px;
        }
        BODY.product-abtest H3.tagline{
            margin-bottom: 20px;
            font-size: 16px;
        }
        
        BODY.product-abtest div.abtest-control h2 {
            font-size: 32px;
            margin-bottom: 10px;
        }
        BODY.product-abtest div.abtest-control h1 {
            font-size: 20px;
            margin-bottom: 10px;
        }
        BODY.product-abtest div.abtest-control H3{
            margin-bottom: 20px;
            font-size: 16px;
        }
        BODY.product-abtest div.abtest-control .flex-control-thumbs li{
            width: 60px !important;
        }
        DIV#mattress-base H3.base{
            font-weight: 300;
            line-height: 15px;
        }
        BODY.product-abtest div.abtest-control #add-to-cart-form #product-add-to-cart{
            line-height: 45px;
        }
        BODY.product-abtest div.abtest-control .product{
            margin-bottom: 5px;
        }
        div.abtest-var1 .mobile-product-meta,
        div.abtest-var1 .mobile-collection-menu,
        div.abtest-var1 .product-meta-mobile {
            display: block;
        }
        div.abtest-var1 .breadcrumb-wrap {
            display: none;
        }
        div.abtest-var1 .selectize-control{
            display: block
        }
    }


    /* iPhone 6 Plus */

    @media (max-width: 414px) {
        .breadcrumb-wrap {
            height: 57px;
        }
        .product-meta-mobile,
        .product-meta-mobile .add-to-cart {
            height: 45px;
        }

    }

    
</style>

<div class="abtest-control">
    {% include 'bold-product' with product, hide_action: 'break' %}{% if bold_hidden_product %}{% break %}{%endif %}
    <div class="container-fluid" id="product">
        <div itemscope itemtype="http://schema.org/Product" class="product">
            <meta itemprop="url" content="{{ shop.url }}{{ product.url }}">
            <meta itemprop="image" src="{{ product.featured_image.src | product_img_url: 'grande' }}" alt="{{ product.title | escape }}">


            <div class="row">
                {% assign featured_image = product.selected_or_first_available_variant.featured_image | default: product.featured_image %}
                <!-- FLEXSLIDER -->
                <div class="col-xs-12 col-md-7" id="product-image-main">
                    <section class="slider">
                        <div class="flexslider">
                            <ul class="slides">
                                {% for image in product.images %}
                                <li data-thumb="{{ image.src | product_img_url: 'small' }}">
                                    <img src="{{ image.src | product_img_url: '1024x1024' }}" alt="{{ image.alt | escape }}">
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </section>
                </div>
                {%comment%}
                to remove the pull-left for single products
                {%endcomment%}
                {% assign multi_prd = true %}
                {% if collection.products_count <= 1 %}
                    {% assign multi_prd = false %}
                {% endif %}
                <div class="col-xs-12 col-md-5 product-shop">
                <div>
                    <header class="product-title {% if collection.previous_product or collection.next_product and settings.display_prev_next_product and collection %}has-btn{% endif %}">
                        <h1 {% if settings.display_prev_next_product and collection and multi_prd %}class="pull-left"{%endif%} itemprop="name">{{ product.title }}</h1>

                        {% if settings.display_prev_next_product and collection and multi_prd %}
                        <div class="product-step">
                            {% if collection.previous_product %}
                            <a class="prev-p" href="{{ collection.next_product }}" title="Prev"><span class="fa fa-angle-left"></span>Previous</a>
                            {% endif %}
                            {% if collection.next_product %}
                            <a class="next-p" href="{{ collection.next_product }}" title="Next">Next<span class=" fa fa-angle-right"></span></a>
                            {% endif %}
                        </div>
                        {%else%}
                        <div class="clearfix"></div>
                        {% endif %}
                    </header>

                    {% if settings.display_product_reviews %}
                    <span class="shopify-product-reviews-badge" data-id="{{ product.id }}"></span>
                    {% endif %}

                    {% if settings.display_availability or settings.display_product_type or settings.display_vendor %}
                    {% if settings.display_availability %}
                    <div class="availability">
                        <p class="product-inventory"> <label>Availability</label><span>
                            {% if product.selected_or_first_available_variant.inventory_management %}
                            {% assign first_inventory = product.selected_or_first_available_variant.inventory_quantity %}
                            {% if first_inventory > 0 %}
                            {{first_inventory}} in stock
                            {% else %}
                            Out of stock
                            {% endif %}
                            {% else %}
                            Many in stock
                            {% endif %}
                            </span></p>
                    </div>
                    {% endif %}
                    {% endif %}



                    <h3 class="text-left">{{product.metafields.bhsite.feel}}</h3>
                    <p class="short-description">{{product.metafields.bhsite.shortdesc}}</p>
                    <div class="yotpo bottomLine"
                         data-appkey="MoTNJx7IZaWhweNlLkQdd6AaJffubtZuHPH6w3aQ"
                         data-domain="{{ shop.permanent_domain | escape }}"
                         data-product-id="{{ product.id }}"
                         data-product-models="{{ product.id }}"
                         data-name="{{ product.title | escape }}"
                         data-url="{{ shop.url }}{{ product.url }}"
                         data-image-url="{{ product.featured_image | product_img_url: 'large' |replace: '?', '%3F' | replace: '&','%26'}}"
                         data-description="{{ product.description | escape }}"
                         data-bread-crumbs="{% for tag in product.tags %}{{ tag | escape }};{% endfor %}">
                    </div>

                    <form action="/cart/add" method="post" enctype="multipart/form-data" id="add-to-cart-form">
                        {%comment%}<div id="product-variants">
                            {% assign variantCount = product.variants | size %}
                            {% if product.available %}
                            {% if variantCount > 1 %}
                            <select id="product-selectors" name="id" style="display:none">
                                {% for variant in product.variants %}
                                <option {% if variant == product.selected_or_first_available_variant %} selected="selected" {% endif %} value="{{ variant.id }}">{{ variant.title }} - {{ variant.price | money }}</option>
                                {% endfor %}
                            </select>

                            {% if settings.use_color_swatch %}
                            {% for option in product.options %}
                            {% include 'swatch' with option %}
                            {% endfor %}
                            {% endif %}
                            {% else %}
                            <input type="hidden" name="id" value="{{ product.variants[0].id }}" />
                            {% endif %}
                            {% endif %}
                        </div>{%endcomment%}
                        
                        
                        
                        <div id="product-variants">
                            <div class="selector-wrapper">
                                <label>Size</label>
                                <select class="single-option-selector selectized" data-option="option1" id="product-selectors-option-0" tabindex="-1" style="display: none;">
                                    <option value="Twin" selected="selected"></option>
                                </select>
                                <div class="selectize-control single-option-selector single">
                                    <div class="selectize-input items full has-options has-items">
                                        <div data-value="Twin" class="item">Twin</div>
                                        <input autocomplete="off" tabindex="" style="width: 4px;" disabled="disabled" type="text">
                                    </div>
                                    <div class="selectize-dropdown single-option-selector single" style="display: none;">
                                        <div class="selectize-dropdown-content"></div>
                                    </div>
                                </div>
                            </div>
                            <select id="product-selectors" name="id" style="display:none">
                                <option selected="selected" value="4749615235">Twin - $ 350.00</option>
                                <option value="4749615299">Twin XL - $ 385.00</option>
                                <option value="4749615363">Full - $ 500.00</option>
                                <option value="4749615491">Full XL - $ 600.00</option>
                                <option value="4749615555">Queen - $ 575.00</option>
                                <option value="4749615747">King - $ 725.00</option>
                                <option value="4749615875">CA King - $ 725.00</option>
                                <option value="4749616003">Olympic Queen - $ 675.00</option>
                                <option value="4749616067">Split Queen - $ 675.00</option>
                                <option value="4749616131">Split King - $ 825.00</option>
                                <option value="4749616195">Split CA King - $ 825.00</option>
                                <option value="4749616259">RV/Short Twin - $ 450.00</option>
                                <option value="4749616323">RV/Short Full - $ 600.00</option>
                                <option value="4749616387">RV/Short Queen - $ 675.00</option>
                                <option value="4749616451">RV/Short King - $ 825.00</option>
                            </select>
                        </div>
                        
                        
                        
                        {% if product.available %}
                        <div class="clearfix">
                            <div id="qt">QTY: <input type="text" id="quantity" name="quantity" value="1"></div>
                            <!-- PRICE -->
                            <div class="prices" itemprop="offers" itemscope itemtype="http://schema.org/Offer" style="float: right;">
                                <meta itemprop="priceCurrency" content="{{ shop.currency }}">
                                {% if product.compare_at_price > product.price %}
                                <span class="compare-price">{{ product.compare_at_price_max | money }}</span>
                                <span class="price on-sale" itemprop="price" content="{{ product.price | money_without_currency | remove: ',' }}">{{ product.price | money }}</span>
                                {% else %}
                                <span class="price" itemprop="price" content="{{ product.price | money_without_currency | remove: ',' }}">{{ product.price | money }}</span>
                                {% endif %}
                                {% if product.available %}
                                <link itemprop="availability" href="http://schema.org/InStock">
                                {% else %}
                                <link itemprop="availability" href="http://schema.org/OutOfStock">
                                {% endif %}
                            </div>
                        </div>
                        {% if product.metafields.yotpo.reviews_count and product.metafields.yotpo.reviews_count != "0" %}
                        <div itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating">
                            <meta itemprop="itemReviewed" content="{{ product.title }}">
                            <meta itemprop="ratingValue" content="{{ product.metafields.yotpo.reviews_average }}"> 
                            <meta itemprop="ratingCount" content="{{ product.metafields.yotpo.reviews_count }}">
                        </div>
                        {% endif %}
                        
                        {% if product.selected_or_first_available_variant.inventory_management %}
                        {% assign first_inventory = product.selected_or_first_available_variant.inventory_quantity %}
                        {% if first_inventory < 1 %}
                                                 <div class="out-of-stock">
                        <span class="left"></span>
                        <p class="product-inventory">
                            We’re currently making this item to order.<br> Please allow <b>up to 3 weeks</b> for crafting and shipping.
                        </p>
                        <span class="right"></span>
                        </div>
                    {% endif %}
                    {% endif %}

                    <input type="submit" name="add" class="btn" id="product-add-to-cart" value="Add to Cart">
                    <div class="affirm"><p id="learn-more" style="visibility:hidden"></p></div>
                    {% else %}
                    <input type="submit" name="add" class="btn" id="product-add-to-cart" disabled value="Unavailable">
                    {% endif %}
                    <script>
                        // AddToCart
                        // Track when people enter the checkout flow (ex. click/landing page on checkout button)
                        $( 'input#product-add-to-cart' ).click(function() {
                            fbq('track', 'AddToCart', {
                                content_ids: 'shopify_{{ product.id }}_{% for variant in product.variants %}{{ variant.sku }}{% endfor %}',
                                content_name: '{{ product.title }}_{% for variant in product.variants %}{{ variant.title }}{% endfor %}',
                                content_type: 'product',
                                value:'{{ product.price | money_without_currency }}',
                                currency:'{{shop.currency}}'
                            });
                        });
                    </script>
                    </form>

                {% include 'wishlist-product' %}
                {% include 'product-share' %}


            </div>
        </div>
    </div>
    </div><!-- End Row -->
    </div><!-- End Container for top part (img+buy) -->

    <div class="product-tabs container">

        <br><br>

        {% include 'mattress-platforms' %}

        <br><br>

        <ul class="nav nav-tabs" id="myTab">
            {% if settings.display_product_detail_description %}
            <li class="active"><a data-toggle="tab" href="#collapse-tab1">{{ settings.product_description_title }}</a></li>
            {% endif %}



            {% if settings.display_product_reviews %}
            <li><a data-toggle="tab" href="#collapse-tab2">{{ settings.product_review_title }}</a></li>
            {% endif %}
        </ul>

        <div id="myTabContent" class="tab-content">
            {% if settings.display_product_detail_description %}
            <div id="collapse-tab1" class="tab-pane fade in active">
                {{ product.description }}
            </div>
            {% endif %}



            {% if settings.display_product_reviews %}
            <div id="collapse-tab2" class="tab-pane fade">
                {% comment %}
                Add product review widget, must install Product Review App:
                https://apps.shopify.com/product-reviews
                {% endcomment %}
                <div id="shopify-product-reviews" data-id="{{product.id}}">{{ product.metafields.spr.reviews }}</div>
            </div>
            {% endif %}
        </div>
    </div>
    <script>
        jQuery('#myTab a').click(function (e) {
            e.preventDefault();
            jQuery(this).tab('show');
        })
    </script>



    {{ 'option_selection.js' | shopify_asset_url | script_tag }}


    {% include 'block-productdetail-right' %}


    <script>
    if(1===1){
            

        jQuery(document).ready(function(){
            jQuery("#zt_list_product").owlCarousel({

                itemsCustom : [
                    [600, 3]
                ],
                navigation : true,
                navigationText : ['<i class="fa icon-left"></i>','<i class="fa icon-right"></i>']
            });
        });
        //Shopify.Image.preload({{ product.images | json }}, 'grande');

        {% if settings.display_subtotal and product.available %}
        //update price when changing quantity
        function updatePricing() {
            //try pattern one before pattern 2
            var regex = /([0-9]+[.|,][0-9]+[.|,][0-9]+)/g;
            var unitPriceTextMatch = jQuery('.product .price').text().match(regex);

            if (!unitPriceTextMatch) {
                regex = /([0-9]+[.|,][0-9]+)/g;
                unitPriceTextMatch = jQuery('.product .price').text().match(regex);
            }

            if (unitPriceTextMatch) {
                var unitPriceText = unitPriceTextMatch[0];
                var unitPrice = unitPriceText.replace(/[.|,]/g,'');
                var quantity = parseInt(jQuery('#quantity').val());
                var totalPrice = unitPrice * quantity;

                var totalPriceText = Shopify.formatMoney(totalPrice, window.money_format);

                totalPriceText = totalPriceText.match(regex)[0];

                var regInput = new RegExp(unitPriceText, "g");
                var totalPriceHtml = jQuery('.product .price').html().replace(regInput ,totalPriceText);

                jQuery('.product .total-price span').html(totalPriceHtml);
            }
        }
         jQuery('#quantity').on('change', updatePricing);
         {% endif %}

         var selectCallback = function(variant, selector) {

             var addToCart = jQuery('#product-add-to-cart'),
                 productPrice = jQuery('.product .price'),
                 comparePrice = jQuery('.product .compare-price');

             if (variant) {
                 if (variant.available) {
                     // We have a valid product variant, so enable the submit button
                     addToCart.removeClass('disabled').removeAttr('disabled').val('Add to Cart');

                 } else {
                     // Variant is sold out, disable the submit button
                     addToCart.val('Sold Out').addClass('disabled').attr('disabled', 'disabled');
                 }

                 // Regardless of stock, update the product price
                 productPrice.html(Shopify.formatMoney(variant.price, "{{ shop.money_format }}"));

                 // Also update and show the product's compare price if necessary
                 if ( variant.compare_at_price > variant.price ) {
                     productPrice.addClass("on-sale")
                     comparePrice
                         .html(Shopify.formatMoney(variant.compare_at_price, "{{ shop.money_format }}"))
                         .show();
                 } else {
                     comparePrice.hide();
                     productPrice.removeClass("on-sale");
                 }
                 {% if settings.use_color_swatch %}
                 // BEGIN SWATCHES
                 var form = jQuery('#' + selector.domIdPrefix).closest('form');
                  for (var i=0,length=variant.options.length; i<length; i++) {
                      var radioButton = form.find('.swatch[data-option-index="' + i + '"] :radio[value="' + variant.options[i] +'"]');
                      if (radioButton.size()) {
                          radioButton.get(0).checked = true;
                      }
                  }
                  // END SWATCHES
                  {% endif %}

                  {% if settings.display_subtotal and product.available %}
                  updatePricing();
                   {% endif %}


                   } else {
                       // The variant doesn't exist. Just a safeguard for errors, but disable the submit button anyway
                       addToCart.val('Unavailable').addClass('disabled').attr('disabled', 'disabled');
                   }

                   //update variant inventory
                   {% if settings.display_availability %}
                   if (variant.available) {
                       if (variant.inventory_management!=null) {
                           jQuery(".product-inventory span").text(variant.inventory_quantity + " in stock");
                       } else {
                           jQuery(".product-inventory span").text("Many in stock");
                       }
                   } else {
                       jQuery(".product-inventory span").text("Out of stock");
                   }
                    {% endif %}

                    //display message for sheets and quilts when out of stock
                    if (variant.available) {
                        if (variant.inventory_management!=null) {
                            if(variant.inventory_quantity<1){
                                jQuery(".out-of-stock").show();
                                jQuery(".out-of-stock p").html("We’re currently making this item to order.<br> Please allow <b>up to 3 weeks</b> for crafting and shipping.");
                            }else{
                                jQuery(".out-of-stock").hide();
                            }
                        }
                    } else {
                        jQuery(".out-of-stock p").text("Out of stock");
                    }

                     /*begin variant image*/
                     if (variant && variant.featured_image) {
                         var originalImage = jQuery("#product-featured-image");
                         var newImage = variant.featured_image;
                         var element = originalImage[0];
                         Shopify.Image.switchImage(newImage, element, function (newImageSizedSrc, newImage, element) {
                             jQuery('#zt_list_product img').each(function() {
                                 var grandSize = jQuery(this).attr('src');
                                 grandSize = grandSize.replace('compact','grande');
                                 if (grandSize == newImageSizedSrc) {
                                     console.log(newImageSizedSrc);
                                     jQuery(this).parent().trigger('click');
                                     return false;
                                 }
                             });
                         });
                     }
                     /*end of variant image*/
                     updateAffirmAsLowAs( variant.price ); //Update affirm price
                    };

                    jQuery(function($) {
                        {% if product.available and product.variants.size > 1 %}
                        
                        //hide duplicate size field when control turned off
                  
                            new Shopify.OptionSelectors('product-selectors', {
                                product: {{ product | json }},
                                                        onVariantSelected: selectCallback,
                                                        enableHistoryState: true
                                                        });



                        
                        
                    
                           
                           {% endif %}

                           // Add label if only one product option and it isn't 'Title'. Could be 'Size'.
                           {% if product.options.size == 1 and product.options.first != 'Title' %}
                           $('.selector-wrapper:eq(0)').prepend('<label>{{ product.options.first }}</label>');
                            {% endif %}

                            // Hide selectors if we only have 1 variant and its title contains 'Default'.
                            {% if product.variants.size == 1 and product.variants.first.title contains 'Default' %}
                            $('.selector-wrapper').hide();
                             {% endif %}

                             // Auto-select first available variant on page load. Otherwise the product looks sold out.
                             {% assign found_one_in_stock = false %}
                             {% for variant in product.variants %}
                             {% if variant.available and found_one_in_stock == false %}
                             {% assign found_one_in_stock = true %}
                             {% for option in product.options %}
                             $('.single-option-selector:eq({{ forloop.index0 }})').val({{ variant.options[forloop.index0] | json }}).trigger('change');
                              {% endfor %}
                              {% endif %}
                              {% endfor %}

                              {% if settings.display_product_reviews %}
                              var reviewsTimeout = setInterval(function() {
                                  if (jQuery(".spr-badge-caption").length>0) {
                                      jQuery(".spr-badge-caption").on('click', function() {
                                          jQuery('html,body').animate({
                                              scrollTop: jQuery(".panel:last").offset().top},
                                                                      '400');
                                          jQuery("#collapse-tab4").collapse('show');
                                      });
                                      clearInterval(reviewsTimeout);
                                  }
                              },1000);

                               {% endif %}

                               });
            }//end if variation1 false

    </script>

    <div class="container">
        <div class="row">
            <div class="col-xs-12">
                <div class="yotpo yotpo-main-widget"
                     data-product-id="{{ product.id }}"
                     data-name="{{ product.title | escape }}"
                     data-url="{{ shop.url }}{{ product.url }}"
                     data-image-url="{{ product.featured_image | product_img_url: "large" |replace: '?', '%3F' | replace: '&','%26'}}"
                     data-description="{{ product.description | escape }}">
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        {% if settings.display_related_products %}
        {% if settings.related_products_type == "tags" %}
        {% include 'related-products-by-tags' %}
        {% else %}
        {% include 'related-products' %}
        {% endif %}
        {% endif %}
    </div>


    

    {% include 'affirm-product' %}
    
</div><!-- END AB TEST -->
    

    




<div class="abtest-var1">

    {% include 'bold-product' with product, hide_action: 'break' %}{% if bold_hidden_product %}{% break %}{%endif %}
    <div class="container-fluid" id="product">
        <div itemscope itemtype="http://schema.org/Product" class="product">
            <meta itemprop="url" content="{{ shop.url }}{{ product.url }}">
            <meta itemprop="image" content="{{ product.featured_image.src | product_img_url: 'grande' }}">

            <div class="row">
                <div class="row slick-wrapper">
                    {% assign featured_image = product.selected_or_first_available_variant.featured_image | default: product.featured_image %}
                    <section id="main-product-slider" class="features product-feature slider">
                        {% for image in product.images %}
                        <div style="position: relative;">
                            {% if forloop.first %}
                            <div class="starsFloat">
                                <h2 itemprop="name">{{ product.title | escape }}</h2>
                                <div class="yotpo bottomLine"
                                     data-appkey="MoTNJx7IZaWhweNlLkQdd6AaJffubtZuHPH6w3aQ"
                                     data-domain="{{ shop.permanent_domain | escape }}"
                                     data-product-id="{{ product.id }}"
                                     data-product-models="{{ product.id }}"
                                     data-name="{{ product.title | escape }}"
                                     data-url="{{ shop.url }}{{ product.url }}"
                                     data-image-url="{{ product.featured_image | product_img_url: 'large' |replace: '?', '%3F' | replace: '&','%26'}}"
                                     data-description="{{ product.description | escape }}"
                                     data-bread-crumbs="{% for tag in product.tags %}{{ tag | escape }};{% endfor %}">
                                </div> 
                            </div>
                            {% endif %}
                            <img src="{{ image.src | product_img_url: 'master' }}" alt="{{ image.alt | escape }}" itemprop="image">
                        </div>
                        {% endfor %}
                    </section>
                </div>
            </div>

            <!-- *********************mobile-product-add-to-cart**************************** -->

            <div class="row product-meta-mobile">
                <div class="col-xs-12 nopad">
                    <form action="/cart/add" method="post" enctype="multipart/form-data" id="add-to-cart-form">
                        <div class="model col-lg-6 col-md-6 col-sm-6 col-xs-6 product-shop">
                            <div class="select">
                                {% assign variantCount = product.variants | size %}
                                {% if product.available %}
                                {% if variantCount > 1 %}
                                <select id="product-selectors-mobile" name="id" style="display:none">
                                    {% for variant in product.variants %}
                                    <option {% if variant == product.selected_or_first_available_variant %} selected="selected" {% endif %} value="{{ variant.id }}">{{ variant.title }} - {{ variant.price | money }}</option>
                                    {% endfor %}
                                </select>
                                {% endif %}
                                {% endif %}
                            </div>
                        </div>
                        <div class="add-to-cart col-lg-6 col-md-6 col-sm-6 col-xs-6">
                            {% if product.available %}
                            <input type="submit" name="add" class="btn" id="product-add-to-cart" value="Add to Cart">
                            {% else %}
                            <input type="submit" name="add" class="btn" id="product-add-to-cart" disabled value="Unavailable">
                            {% endif %}
                        </div>
                        <input type="text" id="quantity" name="quantity" value="1" hidden="">
                    </form>
                </div>
                <!-- Price + Affirm Component for mobile -->
                <div class="row mobile-product-meta">
                    <div class="prices product col-xs-12">
                        {% if product.available %}
                        <div class="price text-center" itemprop="offers" itemscope itemtype="http://schema.org/Offer">
                            <meta itemprop="priceCurrency" content="{{ shop.currency }}">
                            {% if product.compare_at_price > product.price %}
                            <span class="compare-price">{{ product.compare_at_price_max | money_without_currency | remove: '.00' }}</span>
                            <span class="price on-sale" itemprop="price" content="{{ product.price | money_without_currency | remove: ',' }}">{{ product.price | money_without_currency | remove: '.00' }}</span> {% else %}
                            <span class="price" itemprop="price" content="{{ product.price | money_without_currency | remove: ',' }}">{{ product.price | money_without_currency | remove: '.00' }}</span> {% endif %}
                        </div>
                        {% endif %}
                        <div class="affirm">
                            <span id="learn-more-mobile" style="visibility:hidden"></span>
                        </div>
                    </div>
                </div>
                <!-- Price + Affirm Component for mobile -->
            </div>
            {% if product.metafields.yotpo.reviews_count and product.metafields.yotpo.reviews_count != "0" %}
            <div itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating">
                <meta itemprop="itemReviewed" content="{{ product.title }}">
                <meta itemprop="ratingValue" content="{{ product.metafields.yotpo.reviews_average }}"> 
                <meta itemprop="ratingCount" content="{{ product.metafields.yotpo.reviews_count }}">
            </div>
            {% endif %}
            
            <!-- **********************************-->
            
            
            
            {% if product.metafields.bhsite.promo %}
            <div class="promo" style="">
                <p class="text-center" style="">{{product.metafields.bhsite.promo}}</p>
            </div>
            {% endif %}

            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-lg-offset-3 text-center product-description">
                        {% if product.metafields.bhsite.tagline %}
                        <h3 class="tagline">
                            {{ product.metafields.bhsite.tagline }}
                        </h3>
                        {% endif %}
                    </div>
                </div>
                {% if product.metafields.bhsite.comfort_support_one %}
                <div class="cb comfort">
                    <div class="col-lg-12 text-center">
                        <h2 class="title">Comfort &amp; Support</h2>
                    </div>
                    <div class="row">
                        <div class="col-sm-8 col-sm-offset-2 col-xs-12 text-center">
                            {{ product.metafields.bhsite.comfort_support_one }}


                        </div>
                    </div>
                    {%comment%}
                    <div class="row">
                        <div class="col-sm-8 col-xs-12 text-center">
                            <h5 style="text-transform: uppercase">SUPPORT</h5>
                            {{ product.metafields.bhsite.comfort_support_one }}
                        </div>
                        <div class="col-sm-4 col-xs-12 text-center">
                            <h5 style="text-transform: uppercase">ABOUT OUR
                                {% for collection in product.collections %}
                                {% assign col = collection.title %}
                                {% endfor %}
                                {{ col }}
                            </h5>
                            {{ product.metafields.bhsite.comfort_support_two }}
                        </div>
                    </div>
                    {%endcomment%}
                </div>
            </div>

            {% endif %}
            <div class="row">
                <div class="cb guarantee">
                    <div class="blue-bg">
                        <div class="col-xs-12 text-center">
                            <h5 class="title">OUR GUARANTEES</h5>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6 text-center">
                            <img src="{{ '120nightsguarantee.svg' | asset_url}}" alt="120-Night Guarantee" />
                            <h5>120-Night Guarantee</h5>
                            <p class="hidden-xs">Sleep on your mattress for up to 120 nights. If you don’t love it, return it for a full refund.</p>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6 text-center">
                            <img src="{{'freeshipping.svg' | asset_url}}" alt="Free Shipping & Return" />
                            <h5>Free Shipping & Returns</h5>
                            <p class="hidden-xs">All of our mattresses ship for free, with free pickups on returns.</p>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6 text-center">
                            <img src="{{ 'madeincali.svg' | asset_url }}" alt="Made in California" />
                            <h5>Made in California</h5>
                            <p class="hidden-xs">We design, develop, and handcraft all of our mattresses here in Los Angeles, CA.</p>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-6 text-center">
                            <img src="{{ '25year.png' | asset_url }}" alt="25-Year Warranty" />
                            <h5>25 Year Limited Warranty</h5>
                            <p class="hidden-xs">We’re proud of our quality, so we back our mattresses with a 25 year warranty.</p>
                        </div>
                        <div class="container">
                            <div class="col-xs-12 text-center">
                                <div class="cta text-center">
                                    {%comment%}<a class="btn btn-white-stroke">Learn More</a>{%endcomment%}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            {% if product.metafields.bhsite.features_slider %}
            <div class="row slider-wrapper">
                <div class="col-lg-12 col-md-12 col-sm-12 col-sx-12 text-center">
                    <h2>Features</h2>
                </div>
                <div class="row">
                    <section class="product-feature slider slick-wrapper">
                        {{ product.metafields.bhsite.features_slider }}
                    </section>
                </div>
            </div>
            


            
           
            {% comment %}
            <div class="row slider-wrapper">
                <div class="col-lg-12 col-md-12 col-sm-12 col-sx-12 text-center">
                    <h2>Key Materials</h2>
                </div>
                <div class="row">
                    <section class="product-feature slider slick-wrapper">
                        {{ product.metafields.bhsite.materials_slider }}
                    </section>
                </div>
            </div>
            {% endcomment %}
            {% endif %} {% if product.metafields.bhsite.materials_grid %}
            <div class="row">
                <div class="cb mattress-details">
                    <div class="white-bg">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-sx-12">
                            <h2 style="margin-bottom: 50px;">{{ product.title}} Details</h2>
                        </div>
                        {{ product.metafields.bhsite.materials_grid }}
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 text-left collapse" id="collapseDetails">
                        {{ product.description }}
                    </div>
                    <div class="col-xs-12 text-center">
                        <button class="btn btn-grey-stroke" type="button" data-toggle="collapse" data-target="#collapseDetails" aria-expanded="false" aria-controls="collapseExample">More Details</button>
                    </div>
                </div>
            </div>
            <script>
                $('button#detailsBtn').click(function() {
                    if ( $('div#collapseDetails').hasClass('in') ) {
                        $(this).text('More Details');
                    } else {
                        $(this).text('Less Details');
                    }
                });
            </script>
            {% endif %}

            <div class="row" style="margin-top: 20px;">
                <div class="cb surfaces">
                    <div class="blue-bg">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-sx-12 text-center">
                            <h5 class="title">WORKS ON MOST SURFACES</h5>
                        </div>
                        {% include 'works-on-most-surfaces' %}
                        <div class="container">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center">
                                <div class="cta text-center">
                                    {%comment%}<a class="btn btn-white-stroke">Learn More</a>{%endcomment%}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="cb ships-free">
                    <div class="white-bg">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-sx-12 text-center">
                            <h2>Ships Free In A Box</h2>
                        </div>
                        <div class="col-lg-8 col-lg-offset-2 text-center product-description">
                            <img src="https://cdn.shopify.com/s/files/1/1507/2946/files/brentwood-home-box.jpg?12165955255194111259" alt="Brentwood Home Mattress Box" />
                        </div>
                        <div class="col-lg-6 col-lg-offset-3 text-center">
                            <p>All of our mattresses are made to order. Our neighbors on the West Coast can expect their new mattress <strong>within 2-5 business days of ordering</strong>, <strong>others within 3-8 business days</strong>.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="cb easy-setup-video">
                    <div class="white-bg">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-sx-12 text-center">
                            <h2>Easy Setup</h2>
                        </div>
                        <div class="col-md-offset-2 col-md-8 col-sm-12 col-sx-12 text-center">
                            <div class="videoWrapper text-center">
                                <iframe src="https://player.vimeo.com/video/175424212" width="640" height="360" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row hidden-xs">
                <div class="cb our-gaurantee">
                    <div class="container img-bg">
                        <div class="col-lg-6 col-lg-offset-3 col-md-8 col-md-offset-2 text-center">
                            <h3 class="caps" style="margin-bottom: 15px; font-size: 40px;">120-Night Guarantee</h3>
                            <p style="font-weight: 300; color: #444;">Sleep on your mattress for up to 120 nights. If you don’t love it, we’ll give you a full refund and pick it up for free.</p>
                            <div class="cta">
                                <a class="btn btn-grey-stroke" href="/pages/returns">Learn More</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="cb faqs">
                    <div class="ltgrey-bg">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-sx-12 text-center">
                            <h2>F.A.Q.</h2>
                        </div>
                        <div class="container">
                            <div class="col-lg-6 text-left">
                                <h5 class="caps">Q: What does the 120-night guarantee cover?</h5>
                                <p>A: When you get your new mattress, you’ll want to give your body at least 30 nights to adjust to your new mattress. Your body might not be used to such contouring support right away. But if you give it some time, and the mattress just isn’t your style, you can contact us within the first 120 days of your purchase, and we’ll arrange for a pickup of your mattress to be donated to a local charity or shelter, free of charge. Please note there is a limit of 2 items per year per household. Standard shipping costs will apply after that.</p>
                            </div>
                            <div class="col-lg-6 text-left">
                                <h5 class="caps">Q: How is it possible that you don’t use chemical fire retardants? Doesn’t every mattress have to use them?</h5>
                                <p>A: Fortunately, it’s totally possible to avoid using chemical fire retardants with a hydrated-silica sand. Hydrated silica is basically crushed quartz and opal gemstones. We also line our mattresses with New Zealand wool, which is another natural fire barrier.</p>
                            </div>
                        </div>
                        <div class="container">
                            <div class="col-lg-12">
                                <div class="cta text-center">
                                    <a class="btn btn-grey-stroke" href="/pages/faq">More Answers</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="yotpoReviews" class="container">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-sx-12 text-center">
                        <h2>Reviews</h2>
                    </div>
                    <div class="col-xs-12">
                        <div class="yotpo yotpo-main-widget"
                             data-product-id="{{ product.id }}"
                             data-name="{{ product.title | escape }}"
                             data-url="{{ shop.url }}{{ product.url }}"
                             data-image-url="{{ product.featured_image | product_img_url: "large" |replace: '?', '%3F' | replace: '&','%26'}}"
                             data-description="{{ product.description | escape }}">
                        </div>
                    </div>
                </div>
            </div>
            {% if settings.display_related_products %}
            {% if settings.related_products_type == "tags" %}
            {% include 'related-products-by-tags' %}
            {% else %}
            <div class="container">{% include 'related-products' %}</div>
            {% endif %}
            {% endif %}
        </div>
    </div>

    <!--{% include 'affirm-product' %}-->

    <!--- Slick Carousel --->
    {{ 'slick.js' | asset_url | script_tag }}
    {{ 'slick.scss' | asset_url | stylesheet_tag }}
    {{ 'slick-theme.css' | asset_url | stylesheet_tag }}
    <script type="text/javascript">
        $(document).on('ready', function() {
            $('.product-feature').slick({
                centerMode: true,
                centerPadding: '180px',
                slidesToShow: 1,
                dots: true,
                responsive: [
                    {
                        breakpoint: 1024,
                        settings: {
                            centerMode: true,
                            centerPadding: '10px',
                            slidesToShow: 1
                        }
                    },
                    {
                        breakpoint: 768,
                        settings: {
                            centerMode: true,
                            centerPadding: '10px',
                            slidesToShow: 1
                        }
                    },
                    {
                        breakpoint: 480,
                        settings: {
                            centerMode: true,
                            centerPadding: '10px',
                            slidesToShow: 1
                        }
                    }
                ]
            });
        });
    </script>

    {% if template == 'product.abtest' %}
    <script>
        $(document).ready(function() {
            function checkWidth() {
                var windowSize = $(window).width();
                if (windowSize < 680) {
                    jQuery(window).scroll(function() {
                        var scroll = jQuery(window).scrollTop();
                        if (scroll > 320) {
                            jQuery(".product-meta-mobile").addClass("is-ticky");
                        }else{
                            jQuery(".product-meta-mobile").removeClass("is-ticky");
                        }
                    });
                }
                else {
                    jQuery(window).scroll(function() {
                        var scroll = jQuery(window).scrollTop();
                        if (scroll > 0) {
                            jQuery(".breadcrumb-wrap").addClass("is-ticky");
                        }else{
                            jQuery(".breadcrumb-wrap").removeClass("is-ticky");
                        }
                    });
                }
            }
            // Execute on load
            checkWidth();
            // Bind event listener
            $(window).resize(checkWidth);
        });
    </script>
    {% endif %}


    <script>
        
        if(window.variation1 == true){
 

            {% if settings.display_subtotal and product.available %}
            //update price when changing quantity
            function updatePricing() {
                //try pattern one before pattern 2
                var regex = /([0-9]+[.|,][0-9]+[.|,][0-9]+)/g;
                var unitPriceTextMatch = jQuery('.product .price').text().match(regex);

                if (!unitPriceTextMatch) {
                    regex = /([0-9]+[.|,][0-9]+)/g;
                    unitPriceTextMatch = jQuery('.product .price').text().match(regex);
                }

                if (unitPriceTextMatch) {
                    var unitPriceText = unitPriceTextMatch[0];
                    var unitPrice = unitPriceText.replace(/[.|,]/g,'');
                    var quantity = parseInt(jQuery('#quantity').val());
                    var totalPrice = unitPrice * quantity;

                    var totalPriceText = Shopify.formatMoney(totalPrice, window.money_format);

                    totalPriceText = totalPriceText.match(regex)[0];

                    var regInput = new RegExp(unitPriceText, "g");
                    var totalPriceHtml = jQuery('.product .price').html().replace(regInput ,totalPriceText);

                    jQuery('.product .total-price span').html(totalPriceHtml);
                }
            }
             jQuery('#quantity').on('change', updatePricing);
             {% endif %}

             var selectCallback = function(variant, selector) {

                 var addToCart = jQuery('#product-add-to-cart'),
                     productPrice = jQuery('.product .price'),
                     comparePrice = jQuery('.product .compare-price');

                 if (variant) {
                     if (variant.available) {
                         // We have a valid product variant, so enable the submit button
                         addToCart.removeClass('disabled').removeAttr('disabled').val('Add to Cart');

                     } else {
                         // Variant is sold out, disable the submit button
                         addToCart.val('Sold Out').addClass('disabled').attr('disabled', 'disabled');
                     }

                     // Regardless of stock, update the product price
                     productPrice.html(Shopify.formatMoney(variant.price, "{{ shop.money_format }}"));

                     // Also update and show the product's compare price if necessary
                     if ( variant.compare_at_price > variant.price ) {
                         productPrice.addClass("on-sale")
                         comparePrice
                             .html(Shopify.formatMoney(variant.compare_at_price, "{{ shop.money_format }}"))
                             .show();
                     } else {
                         comparePrice.hide();
                         productPrice.removeClass("on-sale");
                     }
                     {% if settings.use_color_swatch %}
                     // BEGIN SWATCHES
                     var form = jQuery('#' + selector.domIdPrefix).closest('form');
                      for (var i=0,length=variant.options.length; i<length; i++) {
                          var radioButton = form.find('.swatch[data-option-index="' + i + '"] :radio[value="' + variant.options[i] +'"]');
                          if (radioButton.size()) {
                              radioButton.get(0).checked = true;
                          }
                      }
                      // END SWATCHES
                      {% endif %}

                      {% if settings.display_subtotal and product.available %}
                      updatePricing();
                       {% endif %}


                       } else {
                           // The variant doesn't exist. Just a safeguard for errors, but disable the submit button anyway
                           addToCart.val('Unavailable').addClass('disabled').attr('disabled', 'disabled');
                       }

                       //update variant inventory
                       {% if settings.display_availability %}
                       if (variant.available) {
                           if (variant.inventory_management!=null) {
                               jQuery(".product-inventory span").text(variant.inventory_quantity + " in stock");
                           } else {
                               jQuery(".product-inventory span").text("Many in stock");
                           }
                       } else {
                           jQuery(".product-inventory span").text("Out of stock");
                       }
                        {% endif %}

                        //display message for sheets and quilts when out of stock
                        if (variant.available) {
                            if (variant.inventory_management!=null) {
                                if(variant.inventory_quantity<1){
                                    jQuery(".out-of-stock").show();
                                    jQuery(".out-of-stock p").html("We’re currently making this item to order.<br> Please allow <b>up to 3 weeks</b> for crafting and shipping.");
                                }else{
                                    jQuery(".out-of-stock").hide();
                                }
                            }
                        } else {
                            jQuery(".out-of-stock p").text("Out of stock");
                        }

                         /*begin variant image*/
                         if (variant && variant.featured_image) {
                             var originalImage = jQuery("#product-featured-image");
                             var newImage = variant.featured_image;
                             var element = originalImage[0];
                             Shopify.Image.switchImage(newImage, element, function (newImageSizedSrc, newImage, element) {
                                 jQuery('#zt_list_product img').each(function() {
                                     var grandSize = jQuery(this).attr('src');
                                     grandSize = grandSize.replace('compact','grande');
                                     if (grandSize == newImageSizedSrc) {
                                         console.log(newImageSizedSrc);
                                         jQuery(this).parent().trigger('click');
                                         return false;
                                     }
                                 });
                             });
                         }
                         /*end of variant image*/
                         //updateAffirmAsLowAs( variant.price ); //Update affirm price
                        };

                        jQuery(function($) {
                            {% if product.available and product.variants.size > 1 %}
                            new Shopify.OptionSelectors('product-selectors', {
                                product: {{ product | json }},
                                                        onVariantSelected: selectCallback,
                                                        enableHistoryState: true
                                                        });
                             new Shopify.OptionSelectors('product-selectors-mobile', {
                                 product: {{ product | json }},
                                                         onVariantSelected: selectCallback,
                                                         enableHistoryState: true
                                                         });

                             {% comment %}
                             Use color swatch and linked options (copyright by @carolineschnapp)
                             {% endcomment %}
                             {% if settings.use_color_swatch and product.available and product.options.size > 1 %}
                             Shopify.linkOptionSelectors({{ product | json }});
                              {% endif %}

                              {% if settings.use_color_swatch != true %}
                              jQuery('.single-option-selector').selectize();
                               jQuery('.selectize-input input').attr("disabled","disabled");
                               {% endif %}

                               {% endif %}

                               // Add label if only one product option and it isn't 'Title'. Could be 'Size'.
                               {% if product.options.size == 1 and product.options.first != 'Title' %}
                               $('.selector-wrapper:eq(0)').prepend('<label>{{ product.options.first }}</label>');
                                {% endif %}

                                // Hide selectors if we only have 1 variant and its title contains 'Default'.
                                {% if product.variants.size == 1 and product.variants.first.title contains 'Default' %}
                                $('.selector-wrapper').hide();
                                 {% endif %}

                                 // Auto-select first available variant on page load. Otherwise the product looks sold out.
                                 {% assign found_one_in_stock = false %}
                                 {% for variant in product.variants %}
                                 {% if variant.available and found_one_in_stock == false %}
                                 {% assign found_one_in_stock = true %}
                                 {% for option in product.options %}
                                 $('.single-option-selector:eq({{ forloop.index0 }})').val({{ variant.options[forloop.index0] | json }}).trigger('change');
                                  {% endfor %}
                                  {% endif %}
                                  {% endfor %}

                                  });
        }//variation 1 condition
    </script>


    <!--
    <script>
    $(function() {
    $(".product-meta .model").on("click", function(e) {
    $(".prices").addClass("animate-pricing");
    e.stopPropagation()
    });
    $(document).on("click", function(e) {
    if ($(e.target).is(".prices") === false) {
    $(".prices").removeClass("animate-pricing");
    }
    });
    });
    </script>
    -->

</div>




{% assign current_variant = product.selected_or_first_available_variant %}
<script>
    $(document).ready(function(){
        $("#product-add-to-cart").click(function(){
            
            //PINTEREST
            pintrk('track', 'addtocart', {
                value: '{{ product.price | money_without_currency }}',
                currency: 'USD',
                line_items: [
                    {
                        product_name: '{{product.title}}',
                        product_category: '{{ collection.title }}',
                        product_variant_id: '{% for variant in product.variants %}{{ variant.sku }}{% endfor %}',
                        product_price: '{{ product.price | money_without_currency }}',
                        product_quantity: 1,
                        product_brand: '{{product.vendor}}'
                    }
                ]
            });
            
            //FACEBOOK
            fbq('track', 'AddToCart', {
                content_ids: 'shopify_{{ product.id }}_{{current_variant.sku}}',
                content_name: '{{ product.title }}_{{current_variant.title}}',
                content_type: 'product',
                value:'{{ product.price | money_without_currency }}',
                currency:'{{shop.currency}}'
            });
        });
    });
    
    //MIXPANEL
    $("#product-add-to-cart").click(function(){
        mixpanel.track("Added to Cart", 
        {
            "name": "{{product.title}}",
            "price": '{{ product.price | money_without_currency }}',
            "variant": "{{current_variant.title}}",
            "category": "{{ collection.title }}",
            "currency":'{{shop.currency}}'
        });
    });
    mixpanel.track("Product Viewed",
    {
        "name": "{{product.title}}",
        "price": "{{ product.price | money_without_currency }}",
        "brand": "{{product.vendor}}",
        "category": "{{ collection.title }}",
        "currency":'{{shop.currency}}'
    });
</script>
<script>
    (function(){
        analytics.track('Viewed Product', {
            id: "{{ product.id }}",
            name: "{{ product.title }}",
            type: "{{ product.type }}",
            url: "{{ product.url }}",
            price: "{{ product.price }}",
            priceMin: "{{ product.price_min }}",
            priceMax: "{{ product.price_max }}",
            priceVaries: "{{ product.price_varies }}",
            vendor: "{{ product.vendor }}",
            collections: [{% for collection in product.collections %}"{{ collection.title }}",{% endfor %}],
            available: {{ product.available }},
                        options: ["{{ product.options | join: '", "' }}"],
                        optionsCount: {{ product.options.size }},
                        tag: ["{{ product.tags | join: '", "' }}"]
                        }, {wcapiVersion: '1.0'});
        // track Product Added event
        //Get the add to cart form
        var form = undefined;
        var allForms = document.getElementsByTagName('form');
        for (var i = 0; i < allForms.length; ++i) {
            var _form = allForms[i];
            if (_form.getAttribute('action') === '/cart/add') {
                form = _form;
                break;
            }
        }
        var addToCartButton = undefined;
        var elements = form.getElementsByTagName('*');
        for (var k = 0; k < elements.length; ++k) {
            var el = elements[k];
            if (el.getAttribute('type') === 'submit') {
                addToCartButton = el;
                break;
            }
        }
        if (typeof location.origin === 'undefined')
            location.origin = location.protocol + '//' + location.host;
        if(addToCartButton) {
            addToCartButton.addEventListener('click', function() {
                analytics.track('Added Product', {
                    id: "{{ product.id }}",
                    name: "{{ product.title }}",
                    price: '{{ product.price }}',
                    quantity: '{{ product.quantity }}',
                    cartLink: location.origin + '/cart',
                    value: parseInt('{{ product.quantity }}' || '0', 10) * parseInt('{{ product.price }}' || '0', 10)
                }, {wcapiVersion: '1.0'});
            });
        }
    })();
</script>
